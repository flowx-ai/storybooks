import{j as e}from"./jsx-runtime-j_jdvEMj.js";import{c as se}from"./clsx-B-dksMZM.js";import{r as t}from"./index-B-o1Wr-g.js";import{M as oe,f as ne,g as ie,h as ae,i as ce,j as le}from"./Accordion-uQJSwz_W.js";import{M as m}from"./Icon-C3PZoQlD.js";import{M as de}from"./Button-BcB-tI5y.js";import{M as me}from"./Modal-BFkUgmVZ.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./index-CKNPlJCH.js";import"./index-hPfD200O.js";import"./Card-B2LF1g-7.js";import"./index-DggQIU-7.js";import"./Portal-Kk8hBqhk.js";const fe=({viewerId:c=`pdfjs-viewer-ID${Date.now()}`,viewerFolder:w="assets/pdfjs/web/viewer.html",externalWindow:o=!1,target:i="_blank",showSpinner:j=!0,downloadFileName:r,openFile:v=!0,download:n=!0,startDownload:l,viewBookmark:_=!0,print:h=!0,startPrint:R,fullScreen:T=!0,find:A=!0,zoom:y,nameddest:F,pagemode:k,lastPage:$,rotatecw:U,rotateccw:f,cursor:V,scroll:C,spread:u,locale:b,useOnlyCssZoom:D=!1,errorOverride:O=!1,errorAppend:E=!0,errorMessage:g,diagnosticLogs:B=!0,externalWindowOptions:ee,onBeforePrint:J,onAfterPrint:K,onDocumentLoad:q,onPageChange:H,pdfSrc:G,page:Q})=>{const Z=t.useRef(null),I=t.useRef(),[M,te]=t.useState(null),[d]=t.useState(G),z=t.useCallback(p=>{const{data:s}=p;if(s&&s.viewerId&&s.event&&s.viewerId===c){const x=s.event,N=s.param;x==="beforePrint"&&J?J():x==="afterPrint"&&K?K():x==="pagesLoaded"&&q?q(N):x==="pageChange"&&H&&H(N)}},[c,J,K,q,H]);t.useEffect(()=>(window.addEventListener("message",z,!1),()=>{window.removeEventListener("message",z,!1)}),[z]),t.useEffect(()=>(o||re(),()=>{M&&M.close()}),[d,o]),t.useEffect(()=>()=>{I.current&&I.current()},[]);const re=()=>{var N;if(!d)return;let p;if(d instanceof Blob){const a=URL.createObjectURL(d);p=encodeURIComponent(a),I.current=()=>URL.revokeObjectURL(a)}else if(d instanceof Uint8Array){const a=new Blob([d],{type:"application/pdf"}),X=URL.createObjectURL(a);p=encodeURIComponent(X),I.current=()=>URL.revokeObjectURL(X)}else p=d;let s=w;s+=`?file=${p}`;const x=[`viewerId=${c}`,r&&`fileName=${r}`,`openFile=${v}`,`download=${n}`,l&&`startDownload=${l}`,`viewBookmark=${_}`,`print=${h}`,R&&`startPrint=${R}`,`fullScreen=${T}`,`find=${A}`,$&&`lastpage=${$}`,U&&`rotatecw=${U}`,f&&`rotateccw=${f}`,V&&`cursor=${V}`,C&&`scroll=${C}`,u&&`spread=${u}`,b&&`locale=${b}`,`useOnlyCssZoom=${D}`,g&&`errorMessage=${g}`,O&&`errorOverride=${O}`,E&&`errorAppend=${E}`,Q&&`page=${Q}`,y&&`zoom=${y}`,F&&`nameddest=${F}`,k&&`pagemode=${k}`];if(s+="&"+x.filter(Boolean).join("&"),o){if(!M||M.closed){const a=window.open("",i,ee||"");if(a==null){B&&console.error('For "externalWindow = true", pop-ups should be enabled.');return}te(a),j&&a.document.write(`
            <style>
              .loader {
                position: fixed;
                left: 40%;
                top: 40%;
                border: 16px solid #f3f3f3;
                border-radius: 50%;
                border-top: 16px solid #3498db;
                width: 120px;
                height: 120px;
                animation: spin 2s linear infinite;
              }
              @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
              }
            </style>
            <div class="loader"></div>
          `)}M.location.href=s}else Z.current&&((N=Z.current.contentWindow)==null||N.location.replace(s))};return e.jsx("iframe",{title:"pdfjs-viewer",hidden:o||!o&&!G,ref:Z,width:"100%",height:"100%"})},S=t.forwardRef(({title:c,subTitle:w,file:o,hasAccordion:i=!0,isExpanded:j=!0,previewInModal:r=!1,className:v,style:n,loading:l,error:_,retry:h,dataUniqueid:R,dataTestId:T,documentIcon:A,emptyIcon:y,errorIcon:F,reloadIcon:k,viewIcon:$},U)=>{const[f,V]=t.useState(j),[C,u]=t.useState(!1),b=()=>{u(!0)},D=t.useCallback(B=>{B.key==="Enter"&&b()},[]),O=t.useMemo(()=>{if(r)return()=>e.jsx("div",{tabIndex:0,role:"button",onClick:b,onKeyDown:D,className:"flx-document-preview-view",children:$||e.jsx(m,{name:"eye",className:"flx-document-action-icon"})});if(!i)return()=>e.jsx(m,{name:"empty"})},[D,i,r,$]),E=()=>{!i||r||V(!f)},g=()=>l?e.jsx("div",{className:"flx-viewer-container flx-not-loaded",style:n,children:e.jsx(m,{name:"document_preview_loading",className:"flx-document-loading"})}):_?e.jsxs("div",{className:"flx-viewer-container flx-document-error",style:n,children:[F||e.jsx(m,{name:"document_preview_error"}),e.jsx(de,{className:"flx-document-preview-retry",variant:"text",onClick:()=>h==null?void 0:h(),icon:"left",iconComponent:k||e.jsx(m,{name:"retry"}),children:"Retry loading"})]}):o?e.jsx(fe,{pdfSrc:o}):e.jsx("div",{className:"flx-viewer-container flx-document-empty",style:n,children:y||e.jsx(m,{name:"document_preview_empty"})});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:se([v,"flx-document-preview",{"flx-viewer-closed":r||!f}]),ref:U,"data-uniqueid":R,"data-testid":T,children:e.jsx(oe,{className:"document-viewer-accordion",children:e.jsxs(ne,{defaultOpened:!r&&f,alwaysOpened:!i&&r,children:[e.jsxs(ie,{children:[e.jsx(ae,{caretIcon:O,onClick:E,children:e.jsxs("div",{className:"flx-document-preview-title",children:[e.jsx("div",{className:"flx-document-preview-icon",children:A||e.jsx(m,{name:"documents"})}),c]})}),e.jsx(ce,{children:w})]}),e.jsx(le,{children:e.jsx("div",{className:"flx-viewer-container",style:n,children:g()})})]})})}),r&&e.jsx(me,{dismissible:!0,className:"flx-document-viewer-modal",isOpen:C,onClose:()=>u(!1),onBackdropClick:()=>u(!1),children:g()})]})});S.displayName="FlxDocumentViewer";const ue=t.memo(S);ue.displayName="MemoFlxDocumentViewer";const ke={title:"DocumentViewer",component:S,argTypes:{},render:({title:c,subTitle:w,file:o,loading:i,error:j,hasAccordion:r,previewInModal:v,width:n,height:l})=>e.jsx("div",{className:"flx-default-theme",children:e.jsx(S,{title:c,subTitle:w,file:o,loading:i,error:j,hasAccordion:r,previewInModal:v,style:{width:n>0?`${n}px`:"auto",height:l>0?`${l}px`:"auto"}})})},pe={args:{title:"Title",subTitle:"Sub title",file:"/assets/sample.pdf",loading:!1,error:!1,hasAccordion:!0,previewInModal:!1,width:0,height:500}},L={...pe};var Y,P,W;L.parameters={...L.parameters,docs:{...(Y=L.parameters)==null?void 0:Y.docs,source:{originalSource:`{
  ...DocumentViewerTemplate
} satisfies Story`,...(W=(P=L.parameters)==null?void 0:P.docs)==null?void 0:W.source}}};const Ue=["DocumentViewer"];export{L as DocumentViewer,Ue as __namedExportsOrder,ke as default};
