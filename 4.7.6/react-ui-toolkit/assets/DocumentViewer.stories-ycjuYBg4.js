import{j as e}from"./jsx-runtime-CBDCb4rg.js";import{c as se}from"./clsx-B-dksMZM.js";import{r}from"./index-B-o1Wr-g.js";import{M as oe,f as ne,g as ie,h as ae,i as ce,j as le}from"./Accordion-Dr3fczts.js";import{M as m}from"./Icon-DQNTWSJm.js";import{M as de}from"./Button-DnrjwBWn.js";import{M as me}from"./Modal-BlKFpNd6.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./index-DjIwiQkP.js";import"./index-hPfD200O.js";import"./Card-C1LeSFDx.js";import"./index-qMorCPSe.js";import"./Portal-vLh0jiGk.js";const fe=({viewerId:c=`pdfjs-viewer-ID${Date.now()}`,viewerFolder:w="assets/pdfjs/web/viewer.html",externalWindow:o=!1,target:i="_blank",showSpinner:j=!0,downloadFileName:t,openFile:v=!0,download:n=!0,startDownload:l,viewBookmark:T=!0,print:h=!0,startPrint:R,fullScreen:I=!0,find:A=!0,zoom:F,nameddest:k,pagemode:M,lastPage:b,rotatecw:U,rotateccw:f,cursor:D,scroll:V,spread:u,locale:$,useOnlyCssZoom:C=!1,errorOverride:O=!1,errorAppend:E=!0,errorMessage:g,diagnosticLogs:B=!0,externalWindowOptions:ee,onBeforePrint:J,onAfterPrint:K,onDocumentLoad:q,onPageChange:H,pdfSrc:G,page:Q})=>{const Z=r.useRef(null),L=r.useRef(),[y,te]=r.useState(null),[d]=r.useState(G),z=r.useCallback(p=>{const{data:s}=p;if(s&&s.viewerId&&s.event&&s.viewerId===c){const x=s.event,N=s.param;x==="beforePrint"&&J?J():x==="afterPrint"&&K?K():x==="pagesLoaded"&&q?q(N):x==="pageChange"&&H&&H(N)}},[c,J,K,q,H]);r.useEffect(()=>(window.addEventListener("message",z,!1),()=>{window.removeEventListener("message",z,!1)}),[z]),r.useEffect(()=>(o||re(),()=>{y&&y.close()}),[d,o]),r.useEffect(()=>()=>{L.current&&L.current()},[]);const re=()=>{var N;if(!d)return;let p;if(d instanceof Blob){const a=URL.createObjectURL(d);p=encodeURIComponent(a),L.current=()=>URL.revokeObjectURL(a)}else if(d instanceof Uint8Array){const a=new Blob([d],{type:"application/pdf"}),X=URL.createObjectURL(a);p=encodeURIComponent(X),L.current=()=>URL.revokeObjectURL(X)}else p=d;let s=w;s+=`?file=${p}`;const x=[`viewerId=${c}`,t&&`fileName=${t}`,`openFile=${v}`,`download=${n}`,l&&`startDownload=${l}`,`viewBookmark=${T}`,`print=${h}`,R&&`startPrint=${R}`,`fullScreen=${I}`,`find=${A}`,b&&`lastpage=${b}`,U&&`rotatecw=${U}`,f&&`rotateccw=${f}`,D&&`cursor=${D}`,V&&`scroll=${V}`,u&&`spread=${u}`,$&&`locale=${$}`,`useOnlyCssZoom=${C}`,g&&`errorMessage=${g}`,O&&`errorOverride=${O}`,E&&`errorAppend=${E}`,Q&&`page=${Q}`,F&&`zoom=${F}`,k&&`nameddest=${k}`,M&&`pagemode=${M}`];if(s+="&"+x.filter(Boolean).join("&"),o){if(!y||y.closed){const a=window.open("",i,ee||"");if(a==null){B&&console.error('For "externalWindow = true", pop-ups should be enabled.');return}te(a),j&&a.document.write(`
            <style>
              .loader {
                position: fixed;
                left: 40%;
                top: 40%;
                border: 16px solid #f3f3f3;
                border-radius: 50%;
                border-top: 16px solid #3498db;
                width: 120px;
                height: 120px;
                animation: spin 2s linear infinite;
              }
              @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
              }
            </style>
            <div class="loader"></div>
          `)}y.location.href=s}else Z.current&&((N=Z.current.contentWindow)==null||N.location.replace(s))};return e.jsx("iframe",{title:"pdfjs-viewer",hidden:o||!o&&!G,ref:Z,width:"100%",height:"100%"})},_=r.forwardRef(({title:c,subTitle:w,file:o,hasAccordion:i=!0,isExpanded:j=!0,previewInModal:t=!1,className:v,style:n,loading:l,error:T,retry:h,dataUniqueid:R,dataTestId:I,documentIcon:A,emptyIcon:F,errorIcon:k,reloadIcon:M,viewIcon:b},U)=>{const[f,D]=r.useState(j),[V,u]=r.useState(!1),$=()=>{u(!0)},C=r.useCallback(B=>{B.key==="Enter"&&$()},[]),O=r.useMemo(()=>{if(t)return()=>e.jsx("div",{tabIndex:0,role:"button",onClick:$,onKeyDown:C,className:"flx-document-preview-view",children:b||e.jsx(m,{name:"eye",className:"flx-document-action-icon"})});if(!i)return()=>e.jsx(m,{name:"empty"})},[C,i,t,b]),E=()=>{!i||t||D(!f)},g=()=>l?e.jsx("div",{className:"flx-viewer-container flx-not-loaded",style:n,children:e.jsx(m,{name:"document_preview_loading",className:"flx-document-loading"})}):T?e.jsxs("div",{className:"flx-viewer-container flx-document-error",style:n,children:[k||e.jsx(m,{name:"document_preview_error"}),e.jsx(de,{className:"flx-document-preview-retry",variant:"text",onClick:()=>h==null?void 0:h(),icon:"left",iconComponent:M||e.jsx(m,{name:"retry"}),children:"Retry loading"})]}):o?e.jsx(fe,{pdfSrc:o}):e.jsx("div",{className:"flx-viewer-container flx-document-empty",style:n,children:F||e.jsx(m,{name:"document_preview_empty"})});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:se([v,"flx-document-preview",{"flx-viewer-closed":t||!f}]),ref:U,"data-uniqueid":R,"data-testid":I,children:e.jsx(oe,{className:"document-viewer-accordion",children:e.jsxs(ne,{defaultOpened:!t&&f,alwaysOpened:!i&&t,disabled:t,children:[e.jsxs(ie,{children:[e.jsx(ae,{caretIcon:O,onClick:E,children:e.jsxs("div",{className:"flx-document-preview-title",children:[e.jsx("div",{className:"flx-document-preview-icon",children:A||e.jsx(m,{name:"documents"})}),c]})}),e.jsx(ce,{alwaysDisplay:t,children:w})]}),e.jsx(le,{children:e.jsx("div",{className:"flx-viewer-container",style:n,children:g()})})]})})}),t&&e.jsx(me,{dismissible:!0,className:"flx-document-viewer-modal",isOpen:V,onClose:()=>u(!1),onBackdropClick:()=>u(!1),children:g()})]})});_.displayName="FlxDocumentViewer";const ue=r.memo(_);ue.displayName="MemoFlxDocumentViewer";const Me={title:"DocumentViewer",component:_,argTypes:{},render:({title:c,subTitle:w,file:o,loading:i,error:j,hasAccordion:t,previewInModal:v,width:n,height:l})=>e.jsx("div",{className:"flx-default-theme",children:e.jsx(_,{title:c,subTitle:w,file:o,loading:i,error:j,hasAccordion:t,previewInModal:v,style:{width:n>0?`${n}px`:"auto",height:l>0?`${l}px`:"auto"}})})},pe={args:{title:"Title",subTitle:"Sub title",file:"/assets/sample.pdf",loading:!1,error:!1,hasAccordion:!0,previewInModal:!1,width:0,height:500}},S={...pe};var Y,P,W;S.parameters={...S.parameters,docs:{...(Y=S.parameters)==null?void 0:Y.docs,source:{originalSource:`{
  ...DocumentViewerTemplate
} satisfies Story`,...(W=(P=S.parameters)==null?void 0:P.docs)==null?void 0:W.source}}};const Ue=["DocumentViewer"];export{S as DocumentViewer,Ue as __namedExportsOrder,Me as default};
