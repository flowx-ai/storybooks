import{j as e}from"./jsx-runtime-CBDCb4rg.js";import{c as se}from"./clsx-B-dksMZM.js";import{r}from"./index-B-o1Wr-g.js";import{M as oe,f as ne,g as ie,h as ae,i as ce,j as le}from"./Accordion-Dr3fczts.js";import{M as m}from"./Icon-DQNTWSJm.js";import{M as de}from"./Button-DnrjwBWn.js";import{M as me}from"./Modal-DjtQBCz3.js";import"./_commonjsHelpers-Cpj98o6Y.js";import"./index-DjIwiQkP.js";import"./index-hPfD200O.js";import"./Card-C1LeSFDx.js";import"./index-qMorCPSe.js";import"./Portal-vLh0jiGk.js";const fe=({viewerId:c=`pdfjs-viewer-ID${Date.now()}`,viewerFolder:w="assets/pdfjs/web/viewer.html",externalWindow:o=!1,target:i="_blank",showSpinner:j=!0,downloadFileName:t,openFile:v=!0,download:n=!0,startDownload:l,viewBookmark:I=!0,print:h=!0,startPrint:N,fullScreen:A=!0,find:B=!0,zoom:R,nameddest:F,pagemode:k,lastPage:b,rotatecw:M,rotateccw:U,cursor:f,scroll:D,spread:V,locale:u,useOnlyCssZoom:C=!1,errorOverride:$=!1,errorAppend:O=!0,errorMessage:E,diagnosticLogs:L=!0,externalWindowOptions:J,onBeforePrint:K,onAfterPrint:q,onDocumentLoad:H,onPageChange:Z,pdfSrc:Q,page:X})=>{const z=r.useRef(null),S=r.useRef(),[g,te]=r.useState(null),[d]=r.useState(Q),G=r.useCallback(p=>{const{data:s}=p;if(s&&s.viewerId&&s.event&&s.viewerId===c){const x=s.event,y=s.param;x==="beforePrint"&&K?K():x==="afterPrint"&&q?q():x==="pagesLoaded"&&H?H(y):x==="pageChange"&&Z&&Z(y)}},[c,K,q,H,Z]);r.useEffect(()=>(window.addEventListener("message",G,!1),()=>{window.removeEventListener("message",G,!1)}),[G]),r.useEffect(()=>(o||re(),()=>{g&&g.close()}),[d,o]),r.useEffect(()=>()=>{S.current&&S.current()},[]);const re=()=>{var y;if(!d)return;let p;if(d instanceof Blob){const a=URL.createObjectURL(d);p=encodeURIComponent(a),S.current=()=>URL.revokeObjectURL(a)}else if(d instanceof Uint8Array){const a=new Blob([d],{type:"application/pdf"}),Y=URL.createObjectURL(a);p=encodeURIComponent(Y),S.current=()=>URL.revokeObjectURL(Y)}else p=d;let s=w;s+=`?file=${p}`;const x=[`viewerId=${c}`,t&&`fileName=${t}`,`openFile=${v}`,`download=${n}`,l&&`startDownload=${l}`,`viewBookmark=${I}`,`print=${h}`,N&&`startPrint=${N}`,`fullScreen=${A}`,`find=${B}`,b&&`lastpage=${b}`,M&&`rotatecw=${M}`,U&&`rotateccw=${U}`,f&&`cursor=${f}`,D&&`scroll=${D}`,V&&`spread=${V}`,u&&`locale=${u}`,`useOnlyCssZoom=${C}`,E&&`errorMessage=${E}`,$&&`errorOverride=${$}`,O&&`errorAppend=${O}`,X&&`page=${X}`,R&&`zoom=${R}`,F&&`nameddest=${F}`,k&&`pagemode=${k}`];if(s+="&"+x.filter(Boolean).join("&"),o){if(!g||g.closed){const a=window.open("",i,J||"");if(a==null){L&&console.error('For "externalWindow = true", pop-ups should be enabled.');return}te(a),j&&a.document.write(`
            <style>
              .loader {
                position: fixed;
                left: 40%;
                top: 40%;
                border: 16px solid #f3f3f3;
                border-radius: 50%;
                border-top: 16px solid #3498db;
                width: 120px;
                height: 120px;
                animation: spin 2s linear infinite;
              }
              @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
              }
            </style>
            <div class="loader"></div>
          `)}g.location.href=s}else z.current&&((y=z.current.contentWindow)==null||y.location.replace(s))};return e.jsx("iframe",{title:"pdfjs-viewer",hidden:o||!o&&!Q,ref:z,width:"100%",height:"100%"})},T=r.forwardRef(({title:c,subTitle:w,file:o,hasAccordion:i=!0,isExpanded:j=!0,previewInModal:t=!1,className:v,style:n,loading:l,error:I,retry:h,dataUniqueid:N,dataTestId:A,documentIcon:B,emptyIcon:R,errorIcon:F,reloadIcon:k,viewIcon:b,language:M},U)=>{const[f,D]=r.useState(j),[V,u]=r.useState(!1),C=()=>{u(!0)},$=r.useCallback(J=>{J.key==="Enter"&&C()},[]),O=r.useMemo(()=>{if(t)return()=>e.jsx("div",{tabIndex:0,role:"button",onClick:C,onKeyDown:$,className:"flx-document-preview-view",children:b||e.jsx(m,{name:"eye",className:"flx-document-action-icon"})});if(!i)return()=>e.jsx(m,{name:"empty"})},[$,i,t,b]),E=()=>{!i||t||D(!f)},L=()=>l?e.jsx("div",{className:"flx-viewer-container flx-not-loaded",style:n,children:e.jsx(m,{name:"document_preview_loading",className:"flx-document-loading"})}):I?e.jsxs("div",{className:"flx-viewer-container flx-document-error",style:n,children:[F||e.jsx(m,{name:"document_preview_error"}),e.jsx(de,{className:"flx-document-preview-retry",variant:"text",onClick:()=>h==null?void 0:h(),icon:"left",iconComponent:k||e.jsx(m,{name:"retry"}),children:"Retry loading"})]}):o?e.jsx(fe,{pdfSrc:o,locale:M}):e.jsx("div",{className:"flx-viewer-container flx-document-empty",style:n,children:R||e.jsx(m,{name:"document_preview_empty"})});return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:se([v,"flx-document-preview",{"flx-viewer-closed":t||!f}]),ref:U,"data-uniqueid":N,"data-testid":A,children:e.jsx(oe,{className:"document-viewer-accordion",children:e.jsxs(ne,{defaultOpened:!t&&f,alwaysOpened:!i&&t,disabled:t,children:[e.jsxs(ie,{children:[e.jsx(ae,{caretIcon:O,onClick:E,children:e.jsxs("div",{className:"flx-document-preview-title",children:[e.jsx("div",{className:"flx-document-preview-icon",children:B||e.jsx(m,{name:"documents"})}),c]})}),e.jsx(ce,{alwaysDisplay:t,children:w})]}),e.jsx(le,{children:e.jsx("div",{className:"flx-viewer-container",style:n,children:L()})})]})})}),t&&e.jsx(me,{dismissible:!0,className:"flx-document-viewer-modal",isOpen:V,onClose:()=>u(!1),onBackdropClick:()=>u(!1),children:L()})]})});T.displayName="FlxDocumentViewer";const ue=r.memo(T);ue.displayName="MemoFlxDocumentViewer";const Me={title:"DocumentViewer",component:T,argTypes:{},render:({title:c,subTitle:w,file:o,loading:i,error:j,hasAccordion:t,previewInModal:v,width:n,height:l})=>e.jsx("div",{className:"flx-default-theme",children:e.jsx(T,{title:c,subTitle:w,file:o,loading:i,error:j,hasAccordion:t,previewInModal:v,style:{width:n>0?`${n}px`:"auto",height:l>0?`${l}px`:"auto"}})})},pe={args:{title:"Title",subTitle:"Sub title",file:"/assets/sample.pdf",loading:!1,error:!1,hasAccordion:!0,previewInModal:!1,width:0,height:500}},_={...pe};var P,W,ee;_.parameters={..._.parameters,docs:{...(P=_.parameters)==null?void 0:P.docs,source:{originalSource:`{
  ...DocumentViewerTemplate
} satisfies Story`,...(ee=(W=_.parameters)==null?void 0:W.docs)==null?void 0:ee.source}}};const Ue=["DocumentViewer"];export{_ as DocumentViewer,Ue as __namedExportsOrder,Me as default};
