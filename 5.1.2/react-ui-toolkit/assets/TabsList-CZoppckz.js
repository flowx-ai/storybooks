import{r as t}from"./index-Bv9Y92EF.js";import{u as Z}from"./useControlled-bC22fXfP.js";import{b as K,u as U}from"./floating-ui.utils.dom-BFiwr5bk.js";import{f as Y,u as k,d as $}from"./useRenderElement-IQYmzFOi.js";import{C as ee,u as te}from"./CompositeList-BVmbKtPS.js";import{u as ne}from"./DirectionContext-C0NX5zCF.js";import{j as L}from"./jsx-runtime-DztICxWZ.js";import{f as oe,o as z,e as ie}from"./owner-CUO6ebsU.js";import{u as V,c as F,n as H}from"./createBaseUIEventDetails-C1JAek35.js";import{u as re,A as se,C as ae}from"./CompositeRoot-VF2UQKiP.js";import{a as ce}from"./useButton-BU0a48-b.js";const W=t.createContext(void 0);function j(){const n=t.useContext(W);if(n===void 0)throw new Error(Y(64));return n}let ue=(function(n){return n.activationDirection="data-activation-direction",n.orientation="data-orientation",n})({});const N={tabActivationDirection:n=>({[ue.activationDirection]:n})},De=t.forwardRef(function(s,l){const{className:b,defaultValue:r=0,onValueChange:o,orientation:i="horizontal",render:g,value:f,...h}=s,d=ne(),x=t.useRef([]),[I,R]=Z({controlled:f,default:r,name:"Tabs",state:"value"}),[T,E]=t.useState(()=>new Map),[a,D]=t.useState(()=>new Map),[v,A]=t.useState("none"),M=K((u,p)=>{o==null||o(u,p),!p.isCanceled&&(R(u),A(p.activationDirection))}),B=t.useCallback((u,p)=>{if(!(u===void 0&&p<0)){for(const e of T.values())if(u!==void 0&&e&&u===(e==null?void 0:e.value)||u===void 0&&(e!=null&&e.index)&&(e==null?void 0:e.index)===p)return e.id}},[T]),c=t.useCallback((u,p)=>{if(!(u===void 0&&p<0)){for(const e of a.values())if(u!==void 0&&p>-1&&u===((e==null?void 0:e.value)??(e==null?void 0:e.index)??void 0)||u===void 0&&p>-1&&p===((e==null?void 0:e.value)??(e==null?void 0:e.index)??void 0))return e==null?void 0:e.id}},[a]),P=t.useCallback(u=>{if(u===void 0)return null;for(const[p,e]of a.entries())if(e!=null&&u===(e.value??e.index))return p;return null},[a]),m=t.useMemo(()=>({direction:d,getTabElementBySelectedValue:P,getTabIdByPanelValueOrIndex:c,getTabPanelIdByTabValueOrIndex:B,onValueChange:M,orientation:i,setTabMap:D,tabActivationDirection:v,value:I}),[d,P,c,B,M,i,D,v,I]),w=k("div",s,{state:{orientation:i,tabActivationDirection:v},ref:l,props:h,stateAttributesMapping:N});return L.jsx(W.Provider,{value:m,children:L.jsx(ee,{elementsRef:x,onMapChange:E,children:w})})}),q=t.createContext(void 0);function le(){const n=t.useContext(q);if(n===void 0)throw new Error(Y(65));return n}const Ae=t.forwardRef(function(s,l){const{className:b,disabled:r=!1,render:o,value:i,id:g,nativeButton:f=!0,...h}=s,{value:d,getTabPanelIdByTabValueOrIndex:x,orientation:I}=j(),{activateOnFocus:R,highlightedTabIndex:T,onTabActivation:E,setHighlightedTabIndex:a,tabsListElement:D}=le(),v=V(g),A=t.useMemo(()=>({disabled:r,id:v,value:i}),[r,v,i]),{compositeProps:M,compositeRef:B,index:c}=re({metadata:A}),P=i??c,m=t.useMemo(()=>i===void 0?c<0?!1:c===d:i===d,[c,d,i]),S=t.useRef(!1);U(()=>{if(S.current){S.current=!1;return}if(!(m&&c>-1&&T!==c))return;const C=D;if(C!=null){const y=oe(z(C));if(y&&ie(C,y))return}a(c)},[m,c,T,a,r,D]);const{getButtonProps:w,buttonRef:u}=ce({disabled:r,native:f,focusableWhenDisabled:!0}),p=c>-1?x(i,c):void 0,e=t.useRef(!1),O=t.useRef(!1);function G(C){m||r||E(P,F(H,C.nativeEvent,void 0,{activationDirection:"none"}))}function J(C){m||(c>-1&&a(c),!r&&R&&(!e.current||e.current&&O.current)&&E(P,F(H,C.nativeEvent,void 0,{activationDirection:"none"})))}function Q(C){if(m||r)return;e.current=!0;function y(){e.current=!1,O.current=!1}(!C.button||C.button===0)&&(O.current=!0,z(C.currentTarget).addEventListener("pointerup",y,{once:!0}))}const X=t.useMemo(()=>({disabled:r,active:m,orientation:I}),[r,m,I]);return k("button",s,{state:X,ref:[l,u,B],props:[M,{role:"tab","aria-controls":p,"aria-selected":m,id:v,onClick:G,onFocus:J,onPointerDown:Q,[se]:m?"":void 0,onKeyDownCapture(){S.current=!0}},h,w]})});let fe=(function(n){return n.index="data-index",n.activationDirection="data-activation-direction",n.orientation="data-orientation",n.hidden="data-hidden",n})({});const Me=t.forwardRef(function(s,l){const{children:b,className:r,value:o,render:i,keepMounted:g=!1,...f}=s,{value:h,getTabIdByPanelValueOrIndex:d,orientation:x,tabActivationDirection:I}=j(),R=V(),T=t.useMemo(()=>({id:R,value:o}),[R,o]),{ref:E,index:a}=te({metadata:T}),v=(o??a)!==h,A=t.useMemo(()=>d(o,a),[d,a,o]),M=t.useMemo(()=>({hidden:v,orientation:x,tabActivationDirection:I}),[v,x,I]);return k("div",s,{state:M,ref:[l,E],props:[{"aria-labelledby":A,hidden:v,id:R??void 0,role:"tabpanel",tabIndex:v?-1:0,[fe.index]:a},f,{children:v&&!g?void 0:b}],stateAttributesMapping:N})}),Be=t.forwardRef(function(s,l){const{activateOnFocus:b=!1,className:r,loopFocus:o=!0,render:i,...g}=s,{getTabElementBySelectedValue:f,onValueChange:h,orientation:d,value:x,setTabMap:I,tabActivationDirection:R}=j(),[T,E]=t.useState(0),[a,D]=t.useState(null),v=de(x,d,a,f),A=K((P,m)=>{if(P!==x){const S=v(P);m.activationDirection=S,h(P,m)}}),M=t.useMemo(()=>({orientation:d,tabActivationDirection:R}),[d,R]),B={"aria-orientation":d==="vertical"?"vertical":void 0,role:"tablist"},c=t.useMemo(()=>({activateOnFocus:b,highlightedTabIndex:T,onTabActivation:A,setHighlightedTabIndex:E,tabsListElement:a,value:x}),[b,T,A,E,a,x]);return L.jsx(q.Provider,{value:c,children:L.jsx(ae,{render:i,className:r,state:M,refs:[l,D],props:[B,g],stateAttributesMapping:N,highlightedIndex:T,enableHomeAndEndKeys:!0,loopFocus:o,orientation:d,onHighlightedIndexChange:E,onMapChange:I,disabledIndices:$})})});function _(n,s){const{left:l,top:b}=n.getBoundingClientRect(),{left:r,top:o}=s.getBoundingClientRect(),i=l-r,g=b-o;return{left:i,top:g}}function de(n,s,l,b){const[r,o]=t.useState(null);return U(()=>{if(n==null||l==null){o(null);return}const i=b(n);if(i==null){o(null);return}const{left:g,top:f}=_(i,l);o(s==="horizontal"?g:f)},[s,b,l,n]),t.useCallback(i=>{if(i===n)return"none";if(i==null)return o(null),"none";if(i!=null&&l!=null){const g=b(i);if(g!=null){const{left:f,top:h}=_(g,l);if(r==null)return o(s==="horizontal"?f:h),"none";if(s==="horizontal"){if(f<r)return o(f),"left";if(f>r)return o(f),"right"}else{if(h<r)return o(h),"up";if(h>r)return o(h),"down"}}}return"none"},[b,s,r,l,n])}export{Ae as T,Be as a,Me as b,De as c};
