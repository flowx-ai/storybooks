import{r as n}from"./index-Bv9Y92EF.js";import{u as X}from"./useControlled-bC22fXfP.js";import{c as _,u as K}from"./floating-ui.utils.dom-cLmtQo3s.js";import{f as U,u as k}from"./useRenderElement-CQQ5I8lv.js";import{C as Z,u as $}from"./CompositeList-oGVV_oZ2.js";import{u as ee}from"./DirectionContext-BpJw-_6G.js";import{j as w}from"./jsx-runtime-DztICxWZ.js";import{f as te,o as z,e as ne}from"./owner-BLNona6N.js";import{u as Y}from"./useBaseUiId-BJFIvnQ9.js";import{u as oe,A as re,C as ie}from"./CompositeRoot-T9Fbzyy1.js";import{c as H}from"./createBaseUIEventDetails-2goIIMRX.js";import{a as se}from"./useButton-BpCaeLYm.js";const V=n.createContext(void 0);function j(){const o=n.useContext(V);if(o===void 0)throw new Error(U(64));return o}let ce=(function(o){return o.activationDirection="data-activation-direction",o.orientation="data-orientation",o})({});const N={tabActivationDirection:o=>({[ce.activationDirection]:o})},Pe=n.forwardRef(function(c,l){const{className:m,defaultValue:t=0,onValueChange:r,orientation:i="horizontal",render:f,value:b,...A}=c,v=ee(),h=n.useRef([]),[T,I]=X({controlled:b,default:t,name:"Tabs",state:"value"}),[x,R]=n.useState(()=>new Map),[u,E]=n.useState(()=>new Map),[d,M]=n.useState("none"),D=_((a,p)=>{r==null||r(a,p),!p.isCanceled&&(I(a),M(p.activationDirection))}),B=n.useCallback((a,p)=>{if(!(a===void 0&&p<0)){for(const e of x.values())if(a!==void 0&&e&&a===(e==null?void 0:e.value)||a===void 0&&(e!=null&&e.index)&&(e==null?void 0:e.index)===p)return e.id}},[x]),s=n.useCallback((a,p)=>{if(!(a===void 0&&p<0)){for(const e of u.values())if(a!==void 0&&p>-1&&a===((e==null?void 0:e.value)??(e==null?void 0:e.index)??void 0)||a===void 0&&p>-1&&p===((e==null?void 0:e.value)??(e==null?void 0:e.index)??void 0))return e==null?void 0:e.id}},[u]),P=n.useCallback(a=>{if(a===void 0)return null;for(const[p,e]of u.entries())if(e!=null&&a===(e.value??e.index))return p;return null},[u]),g=n.useMemo(()=>({direction:v,getTabElementBySelectedValue:P,getTabIdByPanelValueOrIndex:s,getTabPanelIdByTabValueOrIndex:B,onValueChange:D,orientation:i,setTabMap:E,tabActivationDirection:d,value:T}),[v,P,s,B,D,i,E,d,T]),L=k("div",c,{state:{orientation:i,tabActivationDirection:d},ref:l,props:A,stateAttributesMapping:N});return w.jsx(V.Provider,{value:g,children:w.jsx(Z,{elementsRef:h,onMapChange:R,children:L})})}),W=n.createContext(void 0);function ue(){const o=n.useContext(W);if(o===void 0)throw new Error(U(65));return o}const Ae=n.forwardRef(function(c,l){const{className:m,disabled:t=!1,render:r,value:i,id:f,nativeButton:b=!0,...A}=c,{value:v,getTabPanelIdByTabValueOrIndex:h,orientation:T}=j(),{activateOnFocus:I,highlightedTabIndex:x,onTabActivation:R,setHighlightedTabIndex:u,tabsListRef:E}=ue(),d=Y(f),M=n.useMemo(()=>({disabled:t,id:d,value:i}),[t,d,i]),{compositeProps:D,compositeRef:B,index:s}=oe({metadata:M}),P=i??s,g=n.useMemo(()=>i===void 0?s<0?!1:s===v:i===v,[s,v,i]),y=n.useRef(!1);K(()=>{if(y.current){y.current=!1;return}if(!(g&&s>-1&&x!==s))return;const C=E.current,S=te(z(C));C&&S&&ne(C,S)||u(s)},[g,s,x,u,t,E]);const{getButtonProps:L,buttonRef:a}=se({disabled:t,native:b,focusableWhenDisabled:!0}),p=s>-1?h(i,s):void 0,e=n.useRef(!1),O=n.useRef(!1);function q(C){g||t||R(P,H("none",C.nativeEvent,void 0,{activationDirection:"none"}))}function G(C){g||(s>-1&&u(s),!t&&(I&&!e.current||e.current&&O.current)&&R(P,H("none",C.nativeEvent,void 0,{activationDirection:"none"})))}function J(C){if(g||t)return;e.current=!0;function S(){e.current=!1,O.current=!1}(!C.button||C.button===0)&&(O.current=!0,z(C.currentTarget).addEventListener("pointerup",S,{once:!0}))}const Q=n.useMemo(()=>({disabled:t,selected:g,orientation:T}),[t,g,T]);return k("button",c,{state:Q,ref:[l,a,B],props:[D,{role:"tab","aria-controls":p,"aria-selected":g,id:d,onClick:q,onFocus:G,onPointerDown:J,[re]:g?"":void 0,onKeyDownCapture(){y.current=!0}},A,L]})});let ae=(function(o){return o.index="data-index",o.activationDirection="data-activation-direction",o.orientation="data-orientation",o.hidden="data-hidden",o})({});const Me=n.forwardRef(function(c,l){const{children:m,className:t,value:r,render:i,keepMounted:f=!1,...b}=c,{value:A,getTabIdByPanelValueOrIndex:v,orientation:h,tabActivationDirection:T}=j(),I=Y(),x=n.useMemo(()=>({id:I,value:r}),[I,r]),{ref:R,index:u}=$({metadata:x}),d=(r??u)!==A,M=n.useMemo(()=>v(r,u),[v,u,r]),D=n.useMemo(()=>({hidden:d,orientation:h,tabActivationDirection:T}),[d,h,T]);return k("div",c,{state:D,ref:[l,R],props:[{"aria-labelledby":M,hidden:d,id:I??void 0,role:"tabpanel",tabIndex:d?-1:0,[ae.index]:u},b,{children:d&&!f?void 0:m}],stateAttributesMapping:N})}),le=[],Be=n.forwardRef(function(c,l){const{activateOnFocus:m=!0,className:t,loop:r=!0,render:i,...f}=c,{getTabElementBySelectedValue:b,onValueChange:A,orientation:v,value:h,setTabMap:T,tabActivationDirection:I}=j(),[x,R]=n.useState(0),u=n.useRef(null),E=fe(h,v,u,b),d=_((s,P)=>{if(s!==h){const g=E(s);P.activationDirection=g,A(s,P)}}),M=n.useMemo(()=>({orientation:v,tabActivationDirection:I}),[v,I]),D={"aria-orientation":v==="vertical"?"vertical":void 0,role:"tablist"},B=n.useMemo(()=>({activateOnFocus:m,highlightedTabIndex:x,onTabActivation:d,setHighlightedTabIndex:R,tabsListRef:u,value:h}),[m,x,d,R,u,h]);return w.jsx(W.Provider,{value:B,children:w.jsx(ie,{render:i,className:t,state:M,refs:[l,u],props:[D,f],stateAttributesMapping:N,highlightedIndex:x,enableHomeAndEndKeys:!0,loop:r,orientation:v,onHighlightedIndexChange:R,onMapChange:T,disabledIndices:le})})});function F(o,c){const{left:l,top:m}=o.getBoundingClientRect(),{left:t,top:r}=c.getBoundingClientRect(),i=l-t,f=m-r;return{left:i,top:f}}function fe(o,c,l,m){const t=n.useRef(null);return K(()=>{if(o==null||l.current==null){t.current=null;return}const r=m(o);if(r==null){t.current=null;return}const{left:i,top:f}=F(r,l.current);t.current=c==="horizontal"?i:f},[c,m,l,o]),n.useCallback(r=>{if(r===o)return"none";if(r==null)return t.current=null,"none";if(r!=null&&l.current!=null){const i=m(r);if(i!=null){const{left:f,top:b}=F(i,l.current);if(t.current==null)return t.current=c==="horizontal"?f:b,"none";if(c==="horizontal"){if(f<t.current)return t.current=f,"left";if(f>t.current)return t.current=f,"right"}else{if(b<t.current)return t.current=b,"up";if(b>t.current)return t.current=b,"down"}}}return"none"},[m,c,t,l,o])}export{Ae as T,Be as a,Me as b,Pe as c};
