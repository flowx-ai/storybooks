import{j as n}from"./jsx-runtime-NtR90vs_.js";import{r as t}from"./iframe-DMgJMfTy.js";import{c as x}from"./clsx-B-dksMZM.js";import{F as L}from"./Button-BXeyTgse.js";import{a as P,F as E}from"./TextArea-4_YHnEeT.js";import{F as D}from"./Icon-BPlfcXXP.js";import{e as O,M as G}from"./task.constants-D9FsWdym.js";import"./lodash-CmQLOLUV.js";const y=t.forwardRef(({children:e,className:r,...a},s)=>{const l=t.useRef(null);return t.useImperativeHandle(s,()=>l.current),n.jsx("div",{...a,ref:l,className:x("flx-chat",r),children:e})});y.displayName="FlxChat";const T=t.memo(y);T.displayName="MemoFlxChat";try{T.displayName="MemoFlxChat",T.__docgenInfo={description:"",displayName:"MemoFlxChat",props:{ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"((instance: HTMLDivElement | null) => void) | RefObject<HTMLDivElement> | null | undefined"}}}}}catch{}try{y.displayName="FlxChat",y.__docgenInfo={description:"",displayName:"FlxChat",props:{}}}catch{}const C=t.forwardRef(({chatAvatar:e,title:r,subtitle:a,showSeparator:s=!0,buttonClassName:l,newChatLabel:c,onNewChat:p,className:f,...h},o)=>n.jsxs("div",{...h,ref:o,className:x("flx-chat-header",f,!s&&"flx-chat-header-no-separator"),children:[e?n.jsx("div",{className:"flx-chat-header-avatar",children:n.jsx("img",{src:e?.src,alt:e?.alt||"Chat avatar"})}):null,(r||a)&&n.jsxs("div",{className:"flx-chat-header-content",children:[r?n.jsx("h2",{className:"flx-chat-header-title",children:r}):null,a?n.jsx("h3",{className:"flx-chat-header-subtitle",children:a}):null]}),c?n.jsx("div",{className:"flx-chat-header-actions",children:n.jsx(L,{className:l,onClick:p,children:c})}):null]}));C.displayName="FlxChatHeader";const R=t.memo(C);R.displayName="MemoFlxChatHeader";try{R.displayName="MemoFlxChatHeader",R.__docgenInfo={description:"",displayName:"MemoFlxChatHeader",props:{title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string | undefined"}},chatAvatar:{defaultValue:null,description:"",name:"chatAvatar",required:!1,type:{name:"{ src: string; alt: string; } | undefined"}},subtitle:{defaultValue:null,description:"",name:"subtitle",required:!1,type:{name:"string | undefined"}},showSeparator:{defaultValue:{value:"true"},description:"",name:"showSeparator",required:!1,type:{name:"boolean | undefined"}},buttonClassName:{defaultValue:null,description:"",name:"buttonClassName",required:!1,type:{name:"string | undefined"}},newChatLabel:{defaultValue:null,description:"",name:"newChatLabel",required:!1,type:{name:"string | undefined"}},onNewChat:{defaultValue:null,description:"",name:"onNewChat",required:!1,type:{name:"(() => void) | undefined"}},ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"((instance: HTMLDivElement | null) => void) | RefObject<HTMLDivElement> | null | undefined"}}}}}catch{}try{C.displayName="FlxChatHeader",C.__docgenInfo={description:"",displayName:"FlxChatHeader",props:{title:{defaultValue:null,description:"",name:"title",required:!1,type:{name:"string | undefined"}},chatAvatar:{defaultValue:null,description:"",name:"chatAvatar",required:!1,type:{name:"{ src: string; alt: string; } | undefined"}},subtitle:{defaultValue:null,description:"",name:"subtitle",required:!1,type:{name:"string | undefined"}},showSeparator:{defaultValue:{value:"true"},description:"",name:"showSeparator",required:!1,type:{name:"boolean | undefined"}},buttonClassName:{defaultValue:null,description:"",name:"buttonClassName",required:!1,type:{name:"string | undefined"}},newChatLabel:{defaultValue:null,description:"",name:"newChatLabel",required:!1,type:{name:"string | undefined"}},onNewChat:{defaultValue:null,description:"",name:"onNewChat",required:!1,type:{name:"(() => void) | undefined"}}}}}catch{}const M=t.forwardRef(({inputPlaceholder:e,sendAriaLabel:r,sendMessage:a,messageInput:s,className:l,buttonClassName:c,maxInputRows:p=10,sendIconPath:f,sendIconName:h="arrowUp",textAreaClassName:o,sendDisabled:d,...m},g)=>{const[i,v]=t.useState(s),V=t.useMemo(()=>i.trim().length>0&&!d,[i,d]),q=t.useCallback(()=>{if(i.trim()){const u=O(i);a(u),v("")}},[i,a]);return n.jsxs("div",{...m,ref:g,className:x("flx-chat-input",l),children:[n.jsx(P,{className:o,children:n.jsx(E,{placeholder:e,maxRows:Math.max(1,p),value:i,onChange:u=>v(u.target.value),onKeyDown:u=>{u.key==="Enter"&&!u.shiftKey&&(u.preventDefault(),V&&q())},minRows:1})}),n.jsx(L,{className:c,"aria-label":r,onClick:q,disabled:!V,children:n.jsx(D,{name:h,path:f})})]})});M.displayName="FlxChatInput";const j=t.memo(M);j.displayName="MemoFlxChatInput";try{j.displayName="MemoFlxChatInput",j.__docgenInfo={description:"",displayName:"MemoFlxChatInput",props:{buttonClassName:{defaultValue:null,description:"",name:"buttonClassName",required:!1,type:{name:"string | undefined"}},inputPlaceholder:{defaultValue:null,description:"",name:"inputPlaceholder",required:!1,type:{name:"string | undefined"}},sendAriaLabel:{defaultValue:null,description:"",name:"sendAriaLabel",required:!1,type:{name:"string | undefined"}},sendMessage:{defaultValue:null,description:"",name:"sendMessage",required:!0,type:{name:"(message: string) => void"}},messageInput:{defaultValue:null,description:"",name:"messageInput",required:!0,type:{name:"string"}},maxInputRows:{defaultValue:{value:"10"},description:"Max number of rows in the textarea (parity with Angular wrapper `maxInputRows`).",name:"maxInputRows",required:!1,type:{name:"number | undefined"}},sendIconPath:{defaultValue:null,description:"Optional SVG path (static asset URL) for the send icon.",name:"sendIconPath",required:!1,type:{name:"string | undefined"}},sendIconName:{defaultValue:{value:"arrowUp"},description:"Optional fallback icon name when `sendIconPath` is not provided or fails to load.",name:"sendIconName",required:!1,type:{name:"FlxIconName | undefined"}},textAreaClassName:{defaultValue:null,description:"",name:"textAreaClassName",required:!1,type:{name:"string | undefined"}},sendDisabled:{defaultValue:null,description:"",name:"sendDisabled",required:!1,type:{name:"boolean | undefined"}},ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"((instance: HTMLDivElement | null) => void) | RefObject<HTMLDivElement> | null | undefined"}}}}}catch{}try{M.displayName="FlxChatInput",M.__docgenInfo={description:"",displayName:"FlxChatInput",props:{buttonClassName:{defaultValue:null,description:"",name:"buttonClassName",required:!1,type:{name:"string | undefined"}},inputPlaceholder:{defaultValue:null,description:"",name:"inputPlaceholder",required:!1,type:{name:"string | undefined"}},sendAriaLabel:{defaultValue:null,description:"",name:"sendAriaLabel",required:!1,type:{name:"string | undefined"}},sendMessage:{defaultValue:null,description:"",name:"sendMessage",required:!0,type:{name:"(message: string) => void"}},messageInput:{defaultValue:null,description:"",name:"messageInput",required:!0,type:{name:"string"}},maxInputRows:{defaultValue:{value:"10"},description:"Max number of rows in the textarea (parity with Angular wrapper `maxInputRows`).",name:"maxInputRows",required:!1,type:{name:"number | undefined"}},sendIconPath:{defaultValue:null,description:"Optional SVG path (static asset URL) for the send icon.",name:"sendIconPath",required:!1,type:{name:"string | undefined"}},sendIconName:{defaultValue:{value:"arrowUp"},description:"Optional fallback icon name when `sendIconPath` is not provided or fails to load.",name:"sendIconName",required:!1,type:{name:"FlxIconName | undefined"}},textAreaClassName:{defaultValue:null,description:"",name:"textAreaClassName",required:!1,type:{name:"string | undefined"}},sendDisabled:{defaultValue:null,description:"",name:"sendDisabled",required:!1,type:{name:"boolean | undefined"}}}}}catch{}function W(){return{mangle:!1,walkTokens(e){if(e.type!=="link"||!e.href.startsWith("mailto:"))return;const r=e.href.substring(7),a=U(r);e.href=`mailto:${a}`,!(e.tokens.length!==1||e.tokens[0].type!=="text"||e.tokens[0].text!==r)&&(e.text=a,e.tokens[0].text=a)}}}function U(e){let r="",a,s;const l=e.length;for(a=0;a<l;a++)s=e.charCodeAt(a),Math.random()>.5&&(s="x"+s.toString(16)),r+="&#"+s+";";return r}const Z=`
`;function $(e){return e.replace(/\\r|\\n|\r|\n/g,"<br/>").replace(/(?:<br\/>)/g,Z)}function z(e){if(e==null)return e;let a=new G(W()).parse(`${$(e)}`,{async:!1});return/^<p>[\s\S]*<\/p>$/.test(a.trim())&&(a=a.trim().replace(/^<p>([\s\S]*)<\/p>$/,"$1")),a}const b=t.forwardRef(({message:e,avatar:r,chatAvatar:a,errorMessage:s,regenerateLabel:l,onRegenerate:c,buttonClassName:p,className:f,...h},o)=>{const d=!!e?.hasError&&e?.sender==="receiver",m=d?s??e.content:e.content,g=z(m),i=a??r;return n.jsx("div",{...h,ref:o,className:"flx-chat-message",children:n.jsxs("div",{className:x(`flx-chat-message-${e.sender}`,d&&"flx-chat-message-error",f),children:[e.sender==="receiver"&&i?n.jsx("img",{src:i?.src,alt:i?.alt}):null,n.jsx("div",{style:{flex:1},children:n.jsx("span",{dangerouslySetInnerHTML:{__html:g}})}),d&&c?n.jsx(L,{className:p,style:{padding:0},variant:"text",onClick:()=>c(e),children:l??"Regenerate"}):null]})})});b.displayName="FlxChatMessage";const F=t.memo(b);F.displayName="MemoFlxChatMessage";try{F.displayName="MemoFlxChatMessage",F.__docgenInfo={description:"",displayName:"MemoFlxChatMessage",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string | undefined"}},chatAvatar:{defaultValue:null,description:"Chat avatar object (src/alt). Prefer this over the legacy `avatar` prop.",name:"chatAvatar",required:!1,type:{name:"ChatAvatar | undefined"}},buttonClassName:{defaultValue:null,description:"Optional className forwarded to the regenerate button (mirrors `ChatInput` API).",name:"buttonClassName",required:!1,type:{name:"string | undefined"}},message:{defaultValue:null,description:"",name:"message",required:!0,type:{name:"ChatMessage"}},avatar:{defaultValue:null,description:"Legacy avatar prop kept for backwards compatibility.\nPrefer `chatAvatar` to match the Angular API.",name:"avatar",required:!1,type:{name:"{ src: string; alt: string; } | undefined"}},errorMessage:{defaultValue:null,description:"When `message.hasError` is true, this replaces the message content.",name:"errorMessage",required:!1,type:{name:"string | null | undefined"}},regenerateLabel:{defaultValue:null,description:'Label for the "regenerate" action shown when `message.hasError` is true.',name:"regenerateLabel",required:!1,type:{name:"string | undefined"}},onRegenerate:{defaultValue:null,description:'Called when the user clicks "regenerate" while the message is in error state.',name:"onRegenerate",required:!1,type:{name:"((message: ChatMessage) => void) | undefined"}},ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"((instance: HTMLDivElement | null) => void) | RefObject<HTMLDivElement> | null | undefined"}}}}}catch{}try{b.displayName="FlxChatMessage",b.__docgenInfo={description:"",displayName:"FlxChatMessage",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string | undefined"}},chatAvatar:{defaultValue:null,description:"Chat avatar object (src/alt). Prefer this over the legacy `avatar` prop.",name:"chatAvatar",required:!1,type:{name:"ChatAvatar | undefined"}},buttonClassName:{defaultValue:null,description:"Optional className forwarded to the regenerate button (mirrors `ChatInput` API).",name:"buttonClassName",required:!1,type:{name:"string | undefined"}},message:{defaultValue:null,description:"",name:"message",required:!0,type:{name:"ChatMessage"}},avatar:{defaultValue:null,description:"Legacy avatar prop kept for backwards compatibility.\nPrefer `chatAvatar` to match the Angular API.",name:"avatar",required:!1,type:{name:"{ src: string; alt: string; } | undefined"}},errorMessage:{defaultValue:null,description:"When `message.hasError` is true, this replaces the message content.",name:"errorMessage",required:!1,type:{name:"string | null | undefined"}},regenerateLabel:{defaultValue:null,description:'Label for the "regenerate" action shown when `message.hasError` is true.',name:"regenerateLabel",required:!1,type:{name:"string | undefined"}},onRegenerate:{defaultValue:null,description:'Called when the user clicks "regenerate" while the message is in error state.',name:"onRegenerate",required:!1,type:{name:"((message: ChatMessage) => void) | undefined"}}}}}catch{}const N=t.forwardRef(({children:e,className:r,onScroll:a,...s},l)=>{const c=t.useRef(null),p=t.useRef(!0);t.useImperativeHandle(l,()=>c.current);const f=t.useMemo(()=>{const o=t.Children.toArray(e);for(let d=o.length-1;d>=0;d-=1){const m=o[d];if(!t.isValidElement(m))continue;const g=m.props?.message;if(!g||typeof g!="object")continue;const i=g;if(i?.id!=="reasoning"&&(i?.sender==="sender"||i?.sender==="receiver"))return i.sender}return null},[e]),h=t.useCallback(o=>{const d=o.currentTarget,m=d.scrollHeight-d.scrollTop-d.clientHeight;p.current=m<=4,a?.(o)},[a]);return t.useLayoutEffect(()=>{const o=c.current;!o||!(p.current||f==="sender")||(o.scrollTop=o.scrollHeight)},[e,f]),n.jsx("div",{...s,ref:c,className:x("flx-chat-messages",r),onScroll:h,children:e})});N.displayName="FlxChatMessages";const A=t.memo(N);A.displayName="MemoFlxChatMessages";try{A.displayName="MemoFlxChatMessages",A.__docgenInfo={description:"",displayName:"MemoFlxChatMessages",props:{ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"((instance: HTMLDivElement | null) => void) | RefObject<HTMLDivElement> | null | undefined"}}}}}catch{}try{N.displayName="FlxChatMessages",N.__docgenInfo={description:"",displayName:"FlxChatMessages",props:{}}}catch{}const w=t.forwardRef(({message:e,avatar:r,className:a,...s},l)=>n.jsx(F,{...s,ref:l,className:x("flx-chat-reasoning",a),message:{id:"reasoning",content:e??"",sender:"receiver"},avatar:r}));w.displayName="FlxChatReasoning";const H=t.memo(w);H.displayName="MemoFlxChatReasoning";try{H.displayName="MemoFlxChatReasoning",H.__docgenInfo={description:"",displayName:"MemoFlxChatReasoning",props:{message:{defaultValue:null,description:"",name:"message",required:!1,type:{name:"string | undefined"}},avatar:{defaultValue:null,description:"",name:"avatar",required:!1,type:{name:"{ src: string; alt: string; } | undefined"}},thinkingText:{defaultValue:null,description:"",name:"thinkingText",required:!1,type:{name:"string | undefined"}},ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"((instance: HTMLDivElement | null) => void) | RefObject<HTMLDivElement> | null | undefined"}}}}}catch{}try{w.displayName="FlxChatReasoning",w.__docgenInfo={description:"",displayName:"FlxChatReasoning",props:{message:{defaultValue:null,description:"",name:"message",required:!1,type:{name:"string | undefined"}},avatar:{defaultValue:null,description:"",name:"avatar",required:!1,type:{name:"{ src: string; alt: string; } | undefined"}},thinkingText:{defaultValue:null,description:"",name:"thinkingText",required:!1,type:{name:"string | undefined"}}}}}catch{}const B=[{id:"1",sender:"sender",content:"Hi! Can you tell me about **Greek mythology**?"},{id:"2",sender:"receiver",content:`Absolutely! Greek mythology is a collection of stories created by the ancient Greeks about their _gods_, _heroes_, and the nature of the world.

Here are some highlights:
- Gods
- Heroes
- Monsters

| God      | Domain         |
|----------|---------------|
| Zeus     | Sky, Thunder   |
| Poseidon | Sea            |
| Hades    | Underworld     |`},{id:"3",sender:"sender",content:"Who is considered the `chief god` in Greek mythology?"},{id:"4",sender:"receiver",content:`The chief god is **Zeus**.

> He is the ruler of Mount Olympus and controls the sky and thunder.

To read more, check [Wikipedia](https://en.wikipedia.org/wiki/Zeus).`},{id:"5",sender:"sender",content:"What about his family? Did *Zeus* have siblings?"},{id:"6",sender:"receiver",content:`Yes, Zeus had several siblings:

- Hera
- Poseidon
- Hades
- Demeter
- Hestia

Each had their own domain, for example:

\`\`\`
Poseidon: sea
Hades: underworld
\`\`\``},{id:"7",sender:"sender",content:"Who were the **Titans** in these stories?"},{id:"8",sender:"receiver",content:`The Titans were an earlier generation of powerful deities who ruled before the Olympian gods.

They were *overthrown* by Zeus and his siblings in a great war called the **Titanomachy**.`},{id:"9",sender:"sender",content:"Did Greek mythology have important heroes too?"},{id:"10",sender:"receiver",content:`Definitely! Here are some famed heroes:

- **Heracles** – known for his twelve labors
- **Perseus** – famous for slaying Medusa

Their stories often involve: quests, monsters, and challenges.`},{id:"11",sender:"sender",content:"What is the story of Pandora’s box?"},{id:"12",sender:"receiver",content:`Pandora was the first woman created by the gods.

She opened a forbidden box, releasing all the evils into the world.

> Only _hope_ remained inside, according to the myth.`},{id:"13",sender:"sender",content:"Are there famous monsters in Greek mythology?"},{id:"14",sender:"receiver",content:`Yes, there are many! For example:

- **The Minotaur**: half-man, half-bull
- **The Hydra**: a multi-headed serpent

Heroes often *faced* these monsters as part of their quests.`},{id:"15",sender:"sender",content:"How did Greek myths influence modern culture?"},{id:"16",sender:"receiver",content:`Greek mythology has influenced literature, art, and even language.

Many modern books and movies reference these myths, and expressions like "**Achilles heel**" come from them.`}],K=e=>{const{fontFamily:r,messageInput:a="",thinkingText:s,chatAvatar:l,title:c,subtitle:p,inputPlaceholder:f,sendAriaLabel:h,...o}=e,[d,m]=t.useState(()=>[...e.messages??[]]),[g,i]=t.useState(!1),v=t.useRef([]);t.useEffect(()=>{const u=v.current;return()=>{u.forEach(I=>clearTimeout(I))}},[]);const V=u=>{m(k=>[...k,{id:Date.now().toString(),content:u,sender:"sender"}]);const I=setTimeout(()=>i(!0),500),S=setTimeout(()=>{i(!1),m(k=>[...k,{id:(Date.now()+1).toString(),content:"I have finished thinking. Here is the answer:",sender:"receiver"}])},5e3);v.current.push(I,S)},q=t.useMemo(()=>s||"Working on your request...",[s]);return n.jsx("div",{style:{fontFamily:r,height:"calc(100vh - 2rem)"},className:"flx-default-theme",children:n.jsxs(y,{...o,children:[n.jsx(C,{chatAvatar:l,title:c,subtitle:p}),n.jsxs(N,{children:[d.map(u=>n.jsx(b,{message:u,avatar:u.sender==="receiver"?l:void 0},u.id)),g?n.jsx(w,{message:q,avatar:l}):null]}),n.jsx(M,{inputPlaceholder:f,sendAriaLabel:h,sendMessage:V,messageInput:a})]})})},Y={title:"Chat",component:y,argTypes:{fontFamily:{options:["Open Sans","Source Code Pro","Bitter"],control:{type:"select"}}},render:e=>n.jsx(K,{...e})},J={args:{fontFamily:"Open Sans",title:"Chat title",subtitle:"Chat subtitle",chatAvatar:{src:"https://i.pravatar.cc/150?u=24",alt:"Chat avatar"},inputPlaceholder:"Ask me anything...",sendAriaLabel:"Send message",messages:B,messageInput:"",thinkingText:"Working on your request..."}},_={...J};_.parameters={..._.parameters,docs:{..._.parameters?.docs,source:{originalSource:`{
  ...ChatTemplate
} satisfies Story`,..._.parameters?.docs?.source}}};const Q=["Chat"],ie=Object.freeze(Object.defineProperty({__proto__:null,Chat:_,__namedExportsOrder:Q,default:Y},Symbol.toStringTag,{value:"Module"}));export{ie as C,_ as a};
