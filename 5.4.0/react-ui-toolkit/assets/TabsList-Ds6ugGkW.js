import{r as t}from"./iframe-DMgJMfTy.js";import{u as Z}from"./useControlled-DPoCxAFN.js";import{b as _,u as K}from"./floating-ui.utils.dom-BiKb4_oH.js";import{f as U,b as k,d as $}from"./useRenderElement-BDAcc6QV.js";import{C as tt,u as et}from"./CompositeList-5uNVqjSg.js";import{u as nt}from"./DirectionContext-P2oSrbZt.js";import{j as L}from"./jsx-runtime-NtR90vs_.js";import{f as ot,o as z,e as at}from"./owner-CwWlm1ZE.js";import{u as Y,c as F,n as H}from"./createBaseUIEventDetails-DyI0pd9j.js";import{u as it,A as rt,C as st}from"./CompositeRoot-Bq4X5i7Y.js";import{a as ct}from"./useButton-By0iWj5u.js";const W=t.createContext(void 0);function j(){const e=t.useContext(W);if(e===void 0)throw new Error(U(64));return e}let ut=(function(e){return e.activationDirection="data-activation-direction",e.orientation="data-orientation",e})({});const N={tabActivationDirection:e=>({[ut.activationDirection]:e})},Et=t.forwardRef(function(r,l){const{className:m,defaultValue:o=0,onValueChange:a,orientation:n="horizontal",render:g,value:d,...h}=r,f=nt(),x=t.useRef([]),[M,I]=Z({controlled:d,default:o,name:"Tabs",state:"value"}),[C,R]=t.useState(()=>new Map),[s,E]=t.useState(()=>new Map),[v,D]=t.useState("none"),A=_((u,p)=>{a?.(u,p),!p.isCanceled&&(I(u),D(p.activationDirection))}),B=t.useCallback((u,p)=>{if(!(u===void 0&&p<0)){for(const i of C.values())if(u!==void 0&&i&&u===i?.value||u===void 0&&i?.index&&i?.index===p)return i.id}},[C]),c=t.useCallback((u,p)=>{if(!(u===void 0&&p<0)){for(const i of s.values())if(u!==void 0&&p>-1&&u===(i?.value??i?.index??void 0)||u===void 0&&p>-1&&p===(i?.value??i?.index??void 0))return i?.id}},[s]),P=t.useCallback(u=>{if(u===void 0)return null;for(const[p,i]of s.entries())if(i!=null&&u===(i.value??i.index))return p;return null},[s]),b=t.useMemo(()=>({direction:f,getTabElementBySelectedValue:P,getTabIdByPanelValueOrIndex:c,getTabPanelIdByTabValueOrIndex:B,onValueChange:A,orientation:n,setTabMap:E,tabActivationDirection:v,value:M}),[f,P,c,B,A,n,E,v,M]),w=k("div",r,{state:{orientation:n,tabActivationDirection:v},ref:l,props:h,stateAttributesMapping:N});return L.jsx(W.Provider,{value:b,children:L.jsx(tt,{elementsRef:x,onMapChange:R,children:w})})}),q=t.createContext(void 0);function lt(){const e=t.useContext(q);if(e===void 0)throw new Error(U(65));return e}const Dt=t.forwardRef(function(r,l){const{className:m,disabled:o=!1,render:a,value:n,id:g,nativeButton:d=!0,...h}=r,{value:f,getTabPanelIdByTabValueOrIndex:x,orientation:M}=j(),{activateOnFocus:I,highlightedTabIndex:C,onTabActivation:R,setHighlightedTabIndex:s,tabsListElement:E}=lt(),v=Y(g),D=t.useMemo(()=>({disabled:o,id:v,value:n}),[o,v,n]),{compositeProps:A,compositeRef:B,index:c}=it({metadata:D}),P=n??c,b=t.useMemo(()=>n===void 0?c<0?!1:c===f:n===f,[c,f,n]),S=t.useRef(!1);K(()=>{if(S.current){S.current=!1;return}if(!(b&&c>-1&&C!==c))return;const T=E;if(T!=null){const y=ot(z(T));if(y&&at(T,y))return}s(c)},[b,c,C,s,o,E]);const{getButtonProps:w,buttonRef:u}=ct({disabled:o,native:d,focusableWhenDisabled:!0}),p=c>-1?x(n,c):void 0,i=t.useRef(!1),O=t.useRef(!1);function G(T){b||o||R(P,F(H,T.nativeEvent,void 0,{activationDirection:"none"}))}function J(T){b||(c>-1&&s(c),!o&&I&&(!i.current||i.current&&O.current)&&R(P,F(H,T.nativeEvent,void 0,{activationDirection:"none"})))}function Q(T){if(b||o)return;i.current=!0;function y(){i.current=!1,O.current=!1}(!T.button||T.button===0)&&(O.current=!0,z(T.currentTarget).addEventListener("pointerup",y,{once:!0}))}const X=t.useMemo(()=>({disabled:o,active:b,orientation:M}),[o,b,M]);return k("button",r,{state:X,ref:[l,u,B],props:[A,{role:"tab","aria-controls":p,"aria-selected":b,id:v,onClick:G,onFocus:J,onPointerDown:Q,[rt]:b?"":void 0,onKeyDownCapture(){S.current=!0}},h,w]})});let dt=(function(e){return e.index="data-index",e.activationDirection="data-activation-direction",e.orientation="data-orientation",e.hidden="data-hidden",e})({});const At=t.forwardRef(function(r,l){const{children:m,className:o,value:a,render:n,keepMounted:g=!1,...d}=r,{value:h,getTabIdByPanelValueOrIndex:f,orientation:x,tabActivationDirection:M}=j(),I=Y(),C=t.useMemo(()=>({id:I,value:a}),[I,a]),{ref:R,index:s}=et({metadata:C}),v=(a??s)!==h,D=t.useMemo(()=>f(a,s),[f,s,a]),A=t.useMemo(()=>({hidden:v,orientation:x,tabActivationDirection:M}),[v,x,M]);return k("div",r,{state:A,ref:[l,R],props:[{"aria-labelledby":D,hidden:v,id:I??void 0,role:"tabpanel",tabIndex:v?-1:0,[dt.index]:s},d,{children:v&&!g?void 0:m}],stateAttributesMapping:N})}),Bt=t.forwardRef(function(r,l){const{activateOnFocus:m=!1,className:o,loopFocus:a=!0,render:n,...g}=r,{getTabElementBySelectedValue:d,onValueChange:h,orientation:f,value:x,setTabMap:M,tabActivationDirection:I}=j(),[C,R]=t.useState(0),[s,E]=t.useState(null),v=ft(x,f,s,d),D=_((P,b)=>{if(P!==x){const S=v(P);b.activationDirection=S,h(P,b)}}),A=t.useMemo(()=>({orientation:f,tabActivationDirection:I}),[f,I]),B={"aria-orientation":f==="vertical"?"vertical":void 0,role:"tablist"},c=t.useMemo(()=>({activateOnFocus:m,highlightedTabIndex:C,onTabActivation:D,setHighlightedTabIndex:R,tabsListElement:s,value:x}),[m,C,D,R,s,x]);return L.jsx(q.Provider,{value:c,children:L.jsx(st,{render:n,className:o,state:A,refs:[l,E],props:[B,g],stateAttributesMapping:N,highlightedIndex:C,enableHomeAndEndKeys:!0,loopFocus:a,orientation:f,onHighlightedIndexChange:R,onMapChange:M,disabledIndices:$})})});function V(e,r){const{left:l,top:m}=e.getBoundingClientRect(),{left:o,top:a}=r.getBoundingClientRect(),n=l-o,g=m-a;return{left:n,top:g}}function ft(e,r,l,m){const[o,a]=t.useState(null);return K(()=>{if(e==null||l==null){a(null);return}const n=m(e);if(n==null){a(null);return}const{left:g,top:d}=V(n,l);a(r==="horizontal"?g:d)},[r,m,l,e]),t.useCallback(n=>{if(n===e)return"none";if(n==null)return a(null),"none";if(n!=null&&l!=null){const g=m(n);if(g!=null){const{left:d,top:h}=V(g,l);if(o==null)return a(r==="horizontal"?d:h),"none";if(r==="horizontal"){if(d<o)return a(d),"left";if(d>o)return a(d),"right"}else{if(h<o)return a(h),"up";if(h>o)return a(h),"down"}}}return"none"},[m,r,o,l,e])}export{Dt as T,Bt as a,At as b,Et as c};
