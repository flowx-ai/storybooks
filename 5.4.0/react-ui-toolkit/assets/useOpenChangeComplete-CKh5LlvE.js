import{r as d}from"./iframe-DMgJMfTy.js";import{b as m,u as g}from"./floating-ui.utils.dom-BiKb4_oH.js";import{u as p}from"./useRenderElement-BDAcc6QV.js";import{r as h}from"./index-BuszbRwq.js";const S=[];function b(t){d.useEffect(t,S)}const l=null;class k{callbacks=[];callbacksCount=0;nextId=1;startId=1;isScheduled=!1;tick=e=>{this.isScheduled=!1;const n=this.callbacks,c=this.callbacksCount;if(this.callbacks=[],this.callbacksCount=0,this.startId=this.nextId,c>0)for(let s=0;s<n.length;s+=1)n[s]?.(e)};request(e){const n=this.nextId;return this.nextId+=1,this.callbacks.push(e),this.callbacksCount+=1,(!this.isScheduled||!1)&&(requestAnimationFrame(this.tick),this.isScheduled=!0),n}cancel(e){const n=e-this.startId;n<0||n>=this.callbacks.length||(this.callbacks[n]=null,this.callbacksCount-=1)}}const o=new k;class f{static create(){return new f}static request(e){return o.request(e)}static cancel(e){return o.cancel(e)}currentId=l;request(e){this.cancel(),this.currentId=o.request(()=>{this.currentId=l,e()})}cancel=()=>{this.currentId!==l&&(o.cancel(this.currentId),this.currentId=l)};disposeEffect=()=>this.cancel}function A(){const t=p(f.create).current;return b(t.disposeEffect),t}function C(t){return t==null?t:"current"in t?t.current:t}function x(t,e=!1,n=!0){const c=A();return m((s,i=null)=>{c.cancel();const r=C(t);r!=null&&(typeof r.getAnimations!="function"||globalThis.BASE_UI_ANIMATIONS_DISABLED?s():c.request(()=>{function a(){r&&Promise.all(r.getAnimations().map(u=>u.finished)).then(()=>{i!=null&&i.aborted||h.flushSync(s)}).catch(()=>{if(n){if(i!=null&&i.aborted)return;h.flushSync(s)}else r.getAnimations().length>0&&r.getAnimations().some(u=>u.pending||u.playState!=="finished")&&a()})}e?c.request(a):a()}))})}let I=(function(t){return t.startingStyle="data-starting-style",t.endingStyle="data-ending-style",t})({});const E={[I.startingStyle]:""},q={[I.endingStyle]:""},R={transitionStatus(t){return t==="starting"?E:t==="ending"?q:null}};function O(t){const e=p(y,t).current;return e.next=t,g(e.effect),e}function y(t){const e={current:t,next:t,effect:()=>{e.current=e.next}};return e}function T(t){const{enabled:e=!0,open:n,ref:c,onComplete:s}=t,i=O(n),r=m(s),a=x(c,n);d.useEffect(()=>{e&&a(()=>{n===i.current&&r()})},[e,n,r,a,i])}export{f as A,I as T,x as a,A as b,b as c,O as d,C as r,R as t,T as u};
